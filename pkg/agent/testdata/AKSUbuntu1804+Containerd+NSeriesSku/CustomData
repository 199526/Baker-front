#cloud-config

write_files:
- path: /opt/azure/containers/provision_source.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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

- path: /opt/azure/containers/provision_start.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    H4sIAAAAAAAA/5SPTUvzQBSF9/kVhzC8baHzjh+7QuuiBqmLRmwKLoQynV6SaMyNMzelfv13qaIVlKJ3ex7uOY9ZlrVZ2lDAcCPGPraejONabFmTD6bxvC5DyfX/UGA0gllbbyrOP8iqDUJe77CKcxyN/h1GydUkW4zT02SoTqLwEITunFTQumbd2Jw8dIUgVtqA23ZJFclvCrQLpLmVppVdVzrPLubZUHWdlT9/eEZBdgVd4/igF53P0ulill1OpmdD1cXN/Ta4jvDttLY+BznE6lM13kNyg1i9D92HkUf8c955SjaljHlFAyhyfaRvDgMobvpIvGe/DfxLB72IXMFQX2Qi2pSC3dTXAAAA//9qyXjA+QEAAA==

- path: /opt/azure/containers/provision.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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

- path: /opt/azure/containers/provision_installs.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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

- path: /opt/azure/containers/provision_configs.sh
  permissions: "0744"
  encoding: gzip
  owner: root
  content: !!binary |
    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







- path: /usr/local/bin/configure_azure0.sh
  permissions: "0544"
  encoding: gzip
  owner: root
  content: !!binary |
    H4sIAAAAAAAA/6SU0W/bNhDG3/lXfJGFqsVmyR720CQQBsF2N6ONEsTZiiFwDVqiLM4KqZJUPNf2/z5QchS5W7ZhexN0d9/9+N2RvbOg0ipYchEw8Ygl1TkhPUyNpyFFsYVgCdOaqi2MRCJFxleVYqBfKsUG4AI/LythKgzf+oPvSaGXC8UKRjVDn2MPulmj/8678ODtSsWFgfvdwWv+ezt3GLrDSxwDw4OHPVaKleh/5nA+VbW06xCe4R7uDzgLMcD8EiZnggAAS3IJb2rANYQ0TzCzNS9bWC5WR1yvqfmdGwxIxskprvo/uHA+1Q78B9i6zv/XzD2McpaswTOr3GQhEfxYa8VNzhTzfR9CQjCW2tGpSsDkXEMnipfGlgtpSA9RoSVSKTyDDRXmJHeTM1GjVrol6ieCk3ucoZ8hYCYJEsEDwYyfBsNBv07xLUrBtcEcr149wVvyeArD6AMemDBcCotKTdPraIrlZSkyqZDQgif2BGYj1RqlLHiy/YuzkNpYJz7Ju4C7iyd3H69v3y9urj9MR78emtHcw/lzBGEIp+nnYH4ytL93foCl4umKWXxaKEbT7fMtSUkPH9nR3O4geAYtfcJLFFysoXO5eZLr+KUqsSiLasXF6zfYHWlKqYz1cTG6vrqK4nHoDutIQs0/j2OP3z7D8wV9YKAabv2xh58I/gtTmktR/348fu/hN/31/fybEDubftFUfYvnmou24tAtGczt/QhkaWom+8Q0C/QomCEHQjqHiW5/nIXe+7ezxc31eBFHV5PZTTSahCnLaFWYy24kbP2NrNwonnrkxJf4LprGk9vpODw/Pz/vxuLJXTwLA1UJa5HQQStFv9i17qRO39W9mMm/FrmJ7n4Ku8cidpC1Hmiawn29pJrV1rq7tuvhTWeeiMZj0j4U/ZX56qVo9VJWwHlJ0Hle0GG9oJ0G48kHcqLyItUfAQAA//+8Xj4iAgYAAA==

- path: /etc/systemd/system/kubelet.service
  permissions: "0644"
  encoding: gzip
  owner: root
  content: !!binary |
    H4sIAAAAAAAA/4yTT08bMRDF7/sprIhDezCG/rkU+QBloRERRWwQhxBFXu8kGcU73trjEFr63atNCJAQpO5pd/x+783a48ENIQ+zU4g2YMPoSV+kEhxw9t1ThW3lyvA0X2DkqFWKQTlvjVMlkpo9SbNsUECYo4Vhdg2RTWBt3L15iFlOcwyeaiA+QwdaAVtVwdgkx898kayFGPMFcsGGU9SHXz5n+QJs0XpdBdDLvNLEqVC+YWV+pwDKemKDBCGurfbjdAdXzyoMQjZCzU1QDsvn5P/RWsL3epFWdHAsBmLvQ+0TsXgUkwCNuOtsJ911xKO4t0K6j0I6EAdiKI4ET4HEKnaJS1kiVW/afFs4EmPs7Or+yaY2M5BxagK8dcs2OaliS0LJpnQQhWRBpvVwGHmnFJttKaUaAto1tJWwNTXW0xgnKcBoeYoH7Zm9AO/MmLjLxNMjJVCbLyOEOYSNFfIVSGdKcFF39v5c3Jzkvbw/uvx5mo96xyd5r/jb2QDm+pOQ8nmQZEjEWIMOUHsGIdcFGeBXgsiy/fCJ9eHXehcogarGI7FOhItvSqmQ6GVQq1ev+9Hb2WYz3qUaZOPSBElWGFbXpd2CQMAQ1UqxEsRX7N76T896x+fFroXr/Lxb9PPr5V7sKN92+z9G/ePuZb/IskGXIhvnhtmtIYbq5EHXyTHKFCHsswkT4H8BAAD//5yxbXI7BAAA



- path: /etc/apt/apt.conf.d/99periodic
  permissions: "0644"
  owner: root
  content: |
    APT::Periodic::Update-Package-Lists "0";
    APT::Periodic::Download-Upgradeable-Packages "0";
    APT::Periodic::AutocleanInterval "0";
    APT::Periodic::Unattended-Upgrade "0";








- path: /etc/containerd/config.toml
  permissions: "0644"
  owner: root
  content: |
    version = 2
    subreaper = false
    oom_score = 0
    [plugins."io.containerd.grpc.v1.cri"]
      sandbox_image = "oss/kubernetes/pause:1.3.1"
      [plugins."io.containerd.grpc.v1.cri".containerd]
        
        [plugins."io.containerd.grpc.v1.cri".containerd.untrusted_workload_runtime]
          runtime_type = "io.containerd.runtime.v1.linux"
          runtime_engine = "/usr/bin/nvidia-container-runtime"
        [plugins."io.containerd.grpc.v1.cri".containerd.default_runtime]
          runtime_type = "io.containerd.runtime.v1.linux"
          runtime_engine = "/usr/bin/nvidia-container-runtime"
      
      [plugins."io.containerd.grpc.v1.cri".registry.headers]
        X-Meta-Source-Client = ["azure/aks"]
    [metrics]
      address = "127.0.0.1:10257"
    
    #EOF

- path: /etc/containerd/kubenet_template.conf
  permissions: "0644"
  owner: root
  content: |
      {
          "cniVersion": "0.3.1",
          "name": "kubenet",
          "plugins": [{
            "type": "bridge",
            "bridge": "cbr0",
            "mtu": 1500,
            "addIf": "eth0",
            "isGateway": true,
            "ipMasq": true,
            "promiscMode": true,
            "hairpinMode": false,
            "ipam": {
                "type": "host-local",
                "subnet": "{{.PodCIDR}}",
                "routes": [{ "dst": "0.0.0.0/0" }]
            }
          }]
      }

- path: /etc/systemd/system/containerd.service
  permissions: "0644"
  owner: root
  content: |
    [Unit]
    Description=containerd daemon
    After=network.target

    [Service]
    ExecStartPre=/sbin/modprobe overlay
    ExecStart=/usr/bin/containerd
    Delegate=yes
    KillMode=process
    Restart=always
    OOMScoreAdjust=-999
    LimitNOFILE=1048576
    LimitNPROC=infinity
    LimitCORE=infinity

    [Install]
    WantedBy=multi-user.target

    #EOF

- path: /etc/systemd/system/containerd.service.d/exec_start.conf
  permissions: "0644"
  owner: root
  content: |
    [Service]
    ExecStartPost=/sbin/iptables -P FORWARD ACCEPT
    #EOF

- path: /etc/crictl.yaml
  permissions: "0644"
  owner: root
  content: |
    runtime-endpoint: unix:///run/containerd/containerd.sock
    #EOF

- path: /etc/sysctl.d/11-containerd.conf
  permissions: "0644"
  owner: root
  content: |
    net.ipv4.ip_forward = 1
    net.ipv4.conf.all.forwarding = 1
    net.bridge.bridge-nf-call-iptables = 1
    #EOF





- path: /etc/systemd/system/nvidia-modprobe.service
  permissions: "0644"
  owner: root
  content: |
    [Unit]
    Description=Installs and loads Nvidia GPU kernel module
    [Service]
    Type=oneshot
    RemainAfterExit=true
    ExecStartPre=/bin/sh -c "dkms autoinstall --verbose"
    ExecStart=/bin/sh -c "nvidia-modprobe -u -c0"
    ExecStartPost=/bin/sh -c "sleep 10 && systemctl restart kubelet"
    [Install]
    WantedBy=multi-user.target


- path: /etc/kubernetes/certs/ca.crt
  permissions: "0644"
  encoding: base64
  owner: root
  content: |
    

- path: /etc/kubernetes/certs/client.crt
  permissions: "0644"
  encoding: base64
  owner: root
  content: |
    



- path: /var/lib/kubelet/kubeconfig
  permissions: "0644"
  owner: root
  content: |
    apiVersion: v1
    kind: Config
    clusters:
    - name: localcluster
      cluster:
        certificate-authority: /etc/kubernetes/certs/ca.crt
        server: https://:443
    users:
    - name: client
      user:
        client-certificate: /etc/kubernetes/certs/client.crt
        client-key: /etc/kubernetes/certs/client.key
    contexts:
    - context:
        cluster: localcluster
        user: client
      name: localclustercontext
    current-context: localclustercontext
    #EOF

- path: /etc/default/kubelet
  permissions: "0644"
  owner: root
  content: |
    KUBELET_FLAGS=
    KUBELET_REGISTER_SCHEDULABLE=true
    NETWORK_POLICY=
    KUBELET_IMAGE=hyperkube-amd64:v1.15.7


    KUBELET_NODE_LABELS=kubernetes.azure.com/role=agent,node-role.kubernetes.io/agent=,kubernetes.io/role=agent,agentpool=agent2,storageprofile=managed,storagetier=Standard_LRS,accelerator=nvidia,kubernetes.azure.com/cluster=resourceGroupName

    #EOF

- path: /opt/azure/containers/kubelet.sh
  permissions: "0755"
  owner: root
  content: |
    #!/bin/bash

    


    # Disallow container from reaching out to the special IP address 168.63.129.16
    # for TCP protocol (which http uses)
    #
    # 168.63.129.16 contains protected settings that have priviledged info.
    #
    # The host can still reach 168.63.129.16 because it goes through the OUTPUT chain, not FORWARD.
    #
    # Note: we should not block all traffic to 168.63.129.16. For example UDP traffic is still needed
    # for DNS.
    iptables -I FORWARD -d 168.63.129.16 -p tcp --dport 80 -j DROP
    #EOF

- path: /etc/sysctl.d/999-sysctl-aks.conf
  permissions: "0644"
  owner: root
  content: |
    # This is a partial workaround to this upstream Kubernetes issue:
    # https://github.com/kubernetes/kubernetes/issues/41916#issuecomment-312428731
    net.ipv4.tcp_retries2=8
    net.core.message_burst=80
    net.core.message_cost=40
    net.core.somaxconn=16384
    net.ipv4.tcp_max_syn_backlog=16384
    net.ipv4.neigh.default.gc_thresh1=4096
    net.ipv4.neigh.default.gc_thresh2=8192
    net.ipv4.neigh.default.gc_thresh3=16384

    #EOF

runcmd:
- set -x
- . /opt/azure/containers/provision_source.sh
- aptmarkWALinuxAgent hold
